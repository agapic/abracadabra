var app=angular.module("abra",["ngRoute","ui.bootstrap","ngResource","angularSpinners","chart.js","infinite-scroll"]);app.config(["$routeProvider",function(a){a.when("/",{controller:"IndexController",templateUrl:"views/index.html"}).when("/items",{controller:"ItemController",templateUrl:"views/items.html"}).when("/items/:type/:itemId",{controller:"ItemDataController",templateUrl:"views/itemData.html"}).when("/items/:type/:region/:itemId",{controller:"ItemDataController",templateUrl:"views/itemData.html"}).otherwise({templateUrl:"views/404.html",resolve:{err:function(){return{status:404}}}})}]).config(["$locationProvider",function(a){a.hashPrefix("!")}]),app.controller("IndexController",["$scope",function(a){}]),app.controller("ItemController",["$scope","$http","$location","$routeParams","Item",function(b,c,d,e,f){b.itemImages=[],b.init=function(){f.get_item_files({},function(d){function e(a,b){return a.name<b.name?-1:a.name>b.name?1:0}console.log(d),c.get("js/items.json").success(function(c){var f=[],g=c.data;for(a in g){var h=a.toString()+".png";d.indexOf(h)>-1&&f.push(g[a])}console.log(f),f.sort(e);var i=[];f.forEach(function(a){i.push({id:a.id+".png",name:a.name})}),b.itemImages=i})},function(a){console.log("err"+a)})},b.getImagePath=function(a){return"/img/item/"+a}}]),app.controller("ItemDataController",["$scope","$q","$http","$location","$routeParams","Item","spinnerService",function(a,b,c,d,e,f,g){var h={BR:"Brazil",EUW:"Europe West",EUNE:"Europe Northeast",LAN:"Latin America North",LAS:"Latin America South",KR:"Korea",NA:"North America",OCE:"Oceanic",TR:"Turkey",RU:"Russia"};a.items=[],a.spinnerService=g,a.init=function(){a.mv=[],c.get("js/items.json").success(function(b){console.log(b.data[j].name),a.itemName=b.data[j].name});var b=e.type,g=e.region,j=e.itemId;a.type=b.charAt(0).toUpperCase()+b.slice(1),a.region=h[g];f.item_query({type:b,region:g,itemId:j},function(b){if(0==b.length)return d.path("views/404.html");var c=[];for(i in b[0])if("it0wins"==i.substr(0,7)&&c.push(parseInt(i.substr(-3))),2==c.length){a.mv.push(Math.min(c[0],c[1]).toString()),a.mv.push(Math.max(c[0],c[1]).toString());break}b.forEach(function(b){b["it0winrate"+a.mv[0]]=(100*b["it0winrate"+a.mv[0]]).toFixed(2),b["it1winrate"+a.mv[0]]=(100*b["it1winrate"+a.mv[0]]).toFixed(2),b["it2winrate"+a.mv[0]]=(100*b["it2winrate"+a.mv[0]]).toFixed(2),b["it3winrate"+a.mv[0]]=(100*b["it3winrate"+a.mv[0]]).toFixed(2),b["it4winrate"+a.mv[0]]=(100*b["it4winrate"+a.mv[0]]).toFixed(2),b["it5winrate"+a.mv[0]]=(100*b["it5winrate"+a.mv[0]]).toFixed(2),b["it0winrate"+a.mv[1]]=(100*b["it0winrate"+a.mv[1]]).toFixed(2),b["it1winrate"+a.mv[1]]=(100*b["it1winrate"+a.mv[1]]).toFixed(2),b["it2winrate"+a.mv[1]]=(100*b["it2winrate"+a.mv[1]]).toFixed(2),b["it3winrate"+a.mv[1]]=(100*b["it3winrate"+a.mv[1]]).toFixed(2),b["it4winrate"+a.mv[1]]=(100*b["it4winrate"+a.mv[1]]).toFixed(2),b["it5winrate"+a.mv[1]]=(100*b["it5winrate"+a.mv[1]]).toFixed(2),b["totalWins"+a.mv[0]]=b["it0wins"+a.mv[0]]+b["it1wins"+a.mv[0]]+b["it2wins"+a.mv[0]]+b["it3wins"+a.mv[0]]+b["it4wins"+a.mv[0]]+b["it5wins"+a.mv[0]],b["totalWinRate"+a.mv[0]]=parseFloat(b["it0winrate"+a.mv[0]])+parseFloat(b["it1winrate"+a.mv[0]])+parseFloat(b["it2winrate"+a.mv[0]])+parseFloat(b["it3winrate"+a.mv[0]])+parseFloat(b["it4winrate"+a.mv[0]])+parseFloat(b["it5winrate"+a.mv[0]]),b["totalWins"+a.mv[1]]=b["it0wins"+a.mv[1]]+b["it1wins"+a.mv[1]]+b["it2wins"+a.mv[1]]+b["it3wins"+a.mv[1]]+b["it4wins"+a.mv[1]]+b["it5wins"+a.mv[1]],b["totalWinRate"+a.mv[1]]=parseFloat(b["it0winrate"+a.mv[1]])+parseFloat(b["it1winrate"+a.mv[1]])+parseFloat(b["it2winrate"+a.mv[1]])+parseFloat(b["it3winrate"+a.mv[1]])+parseFloat(b["it4winrate"+a.mv[1]])+parseFloat(b["it5winrate"+a.mv[1]]),b.winDifferenceAfterBefore=b["totalWins"+a.mv[1]]-b["totalWins"+a.mv[0]],b.winDifferenceBeforeAfter=b["totalWins"+a.mv[0]]-b["totalWins"+a.mv[1]],b.winRateDifferenceAfterBefore=(b["totalWinRate"+a.mv[1]]-b["totalWinRate"+a.mv[0]]).toFixed(4),b.winRateDifferenceBeforeAfter=(b["totalWinRate"+a.mv[0]]-b["totalWinRate"+a.mv[1]]).toFixed(4)}),console.log(b),console.log(a.mv),a.items=b},function(a){console.log(Object.keys(a))})},a.labels=["1","2","3","4","5","6"],a.series=["5.11 Winrate","5.11 Wins","5.14 Winrate","5.14 Wins"],a.getNormalPath=function(a){var b=d.path().split("/").pop();d.path("/items/normal/"+a+b)},a.getRankedPath=function(a){var b=d.path().split("/").pop();d.path("/items/ranked/"+a+b)},a.sortDropdown="winRateDifferenceAfterBefore",a.sortFunction=function(b){return isNaN(b[a.sortDropdown])?b[a.sortDropdown]:parseFloat(b[a.sortDropdown])},a.getData=function(b){var c=a.mv[0],d=a.mv[1];a.pielabel=[c+" Patch",d+" Patch"],b.it0=[b["it0wins"+c].toString(),b["it0wins"+d].toString()],b.it1=[b["it1wins"+c].toString(),b["it1wins"+d].toString()],b.it2=[b["it2wins"+c].toString(),b["it2wins"+d].toString()],b.it3=[b["it3wins"+c].toString(),b["it3wins"+d].toString()],b.it4=[b["it4wins"+c].toString(),b["it4wins"+d].toString()],b.it5=[b["it5wins"+c].toString(),b["it5wins"+d].toString()],b.data=[[b["it0winrate"+c],b["it1winrate"+c],b["it2winrate"+c],b["it3winrate"+c],b["it4winrate"+c],b["it5winrate"+c]],[b["it0wins"+c],b["it1wins"+c],b["it2wins"+c],b["it3wins"+c],b["it4wins"+c],b["it5wins"+c]],[b["it0winrate"+d],b["it1winrate"+d],b["it2winrate"+d],b["it3winrate"+d],b["it4winrate"+d],b["it5winrate"+d]],[b["it0wins"+d],b["it1wins"+d],b["it2wins"+d],b["it3wins"+d],b["it4wins"+d],b["it5wins"+d]]],console.log(b)}}]),window.app.factory("Item",["$resource",function(a){return a("api/:action/:type/:region/:itemId",{},{get_item_files:{method:"GET",isArray:!0,params:{action:"items"}},item_query:{method:"GET",isArray:!0,params:{action:"items",typeId:"type",regionId:"region",itemId:"itemId"}}})}]),app.filter("reverse",function(){return function(a){return"undefined"!=typeof a?angular.isArray(a)?a.slice().reverse():(a+"").split("").reverse().join(""):void 0}}),app.filter("split",function(){return function(a,b,c){return a.split(b)[c]}});